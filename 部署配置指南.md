# ğŸš€ AstrOb éƒ¨ç½²é…ç½®æŒ‡å—

## ğŸ“‹ ç›®å½•
- [GitHub Pages éƒ¨ç½²](#github-pages-éƒ¨ç½²)
- [Vercel éƒ¨ç½²](#vercel-éƒ¨ç½²)
- [ç¯å¢ƒå˜é‡å¯¹æ¯”](#ç¯å¢ƒå˜é‡å¯¹æ¯”)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ğŸ™ GitHub Pages éƒ¨ç½²

### å‰ç½®æ¡ä»¶
- âœ… GitHub è´¦å·
- âœ… é¡¹ç›®å·²æ¨é€åˆ° GitHub ä»“åº“
- âœ… ä»“åº“ä¸ºå…¬å¼€ï¼ˆæˆ– GitHub Pro è´¦æˆ·ï¼‰

### 1. é…ç½® GitHub Actions

**æ–‡ä»¶**: `.github/workflows/deploy.yml`

```yaml
name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ]
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          
      - name: Install dependencies
        run: npm install
        
      - name: Build site
        run: npm run build:github
        env:
          # âš ï¸ é‡è¦ï¼šè®¾ç½®è¿™äº›ç¯å¢ƒå˜é‡
          SPACESHIP_BASE: /openeducation/  # ä½ çš„ä»“åº“å
          SPACESHIP_SITE: https://your-username.github.io
          SPACESHIP_AUTHOR: My Vault
          
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v2
        with:
          path: ./dist

  deploy:
    needs: build
    runs-on: ubuntu-latest
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v2
```

### 2. GitHub ä»“åº“è®¾ç½®

1. **è¿›å…¥ä»“åº“ Settings**
2. **Pages è®¾ç½®**:
   - Source: `GitHub Actions`
   - Branch: ä¸éœ€è¦é€‰æ‹©ï¼ˆActions è‡ªåŠ¨éƒ¨ç½²ï¼‰
3. **ä¿å­˜é…ç½®**

### 3. ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼Œé€šè¿‡ Secretsï¼‰

å¦‚æœä¸æƒ³åœ¨ä»£ç ä¸­ç¡¬ç¼–ç ï¼š

**Settings â†’ Secrets and variables â†’ Actions â†’ New repository secret**

```
SPACESHIP_BASE = /openeducation/
SPACESHIP_SITE = https://your-username.github.io
SPACESHIP_AUTHOR = My Vault
```

ç„¶ååœ¨ workflow ä¸­ä½¿ç”¨ï¼š
```yaml
env:
  SPACESHIP_BASE: ${{ secrets.SPACESHIP_BASE }}
  SPACESHIP_SITE: ${{ secrets.SPACESHIP_SITE }}
  SPACESHIP_AUTHOR: ${{ secrets.SPACESHIP_AUTHOR }}
```

### 4. æ³¨æ„äº‹é¡¹

| é¡¹ç›® | é…ç½® | è¯´æ˜ |
|------|------|------|
| **base è·¯å¾„** | `/ä»“åº“å/` | å¿…é¡»ä¸ä»“åº“åä¸€è‡´ |
| **site** | `https://username.github.io` | GitHub Pages åŸŸå |
| **Node ç‰ˆæœ¬** | `20.x` | æ¨èä½¿ç”¨ LTS ç‰ˆæœ¬ |
| **æ„å»ºå‘½ä»¤** | `npm run build:github` | ä¸è¦ç”¨ `build`ï¼ˆä¼šåˆ é™¤ node_modulesï¼‰ |

---

## â–² Vercel éƒ¨ç½²

### æ–¹æ³• 1: é€šè¿‡ Vercel Dashboardï¼ˆæ¨èï¼‰

#### 1. å¯¼å…¥é¡¹ç›®

1. è®¿é—® [vercel.com](https://vercel.com)
2. ç‚¹å‡» **"Add New" â†’ "Project"**
3. å¯¼å…¥ GitHub ä»“åº“
4. é€‰æ‹© `AstrOb` é¡¹ç›®

#### 2. é…ç½®æ„å»ºè®¾ç½®

**Framework Preset**: `Astro`

**Build & Development Settings**:
```
Build Command:         npm run build:github
Output Directory:      dist
Install Command:       npm install
Development Command:   npm run dev
```

#### 3. ç¯å¢ƒå˜é‡è®¾ç½®

åœ¨ **"Environment Variables"** æ·»åŠ ï¼š

| Name | Value | Environment |
|------|-------|-------------|
| `SPACESHIP_BASE` | `/openeducation/` æˆ– `/` | All |
| `SPACESHIP_SITE` | `https://your-project.vercel.app` | All |
| `SPACESHIP_AUTHOR` | `My Vault` | All |
| `PWD` | `/vercel/path0` | All |

âš ï¸ **Vercel base è·¯å¾„å»ºè®®**ï¼š
- ä½¿ç”¨æ ¹è·¯å¾„ `/` æ›´ç®€å•
- æˆ–è€…ä½¿ç”¨è‡ªå®šä¹‰å­è·¯å¾„

#### 4. éƒ¨ç½²

ç‚¹å‡» **"Deploy"** æŒ‰é’®ï¼ŒVercel ä¼šè‡ªåŠ¨ï¼š
1. å®‰è£…ä¾èµ–
2. æ„å»ºé¡¹ç›®
3. éƒ¨ç½²åˆ° CDN

---

### æ–¹æ³• 2: ä½¿ç”¨ vercel.json é…ç½®

**æ–‡ä»¶**: `vercel.json`

```json
{
  "buildCommand": "npm run build:github",
  "outputDirectory": "dist",
  "framework": "astro",
  "installCommand": "npm install",
  "devCommand": "npm run dev",
  "env": {
    "SPACESHIP_BASE": "/",
    "SPACESHIP_SITE": "https://your-project.vercel.app",
    "SPACESHIP_AUTHOR": "My Vault"
  },
  "regions": ["hkg1", "sin1"]
}
```

---

### æ–¹æ³• 3: Vercel CLI éƒ¨ç½²

#### å®‰è£… Vercel CLI
```bash
npm install -g vercel
```

#### ç™»å½•
```bash
vercel login
```

#### éƒ¨ç½²
```bash
# é¦–æ¬¡éƒ¨ç½²ï¼ˆä¼šè¯¢é—®é…ç½®ï¼‰
vercel

# æˆ–è€…ç›´æ¥ç”Ÿäº§éƒ¨ç½²
vercel --prod
```

---

## ğŸ”„ ç¯å¢ƒå˜é‡å¯¹æ¯”

| ç¯å¢ƒ | base | site | author | è®¿é—®åœ°å€ |
|------|------|------|--------|---------|
| **æœ¬åœ°å¼€å‘** | `/astro-theme-spaceship/` | `http://localhost:4321` | `My Vault` | `http://localhost:4321/astro-theme-spaceship/` |
| **GitHub Pages** | `/openeducation/` | `https://username.github.io` | `My Vault` | `https://username.github.io/openeducation/` |
| **Vercel** | `/` æˆ–è‡ªå®šä¹‰ | `https://xxx.vercel.app` | `My Vault` | `https://xxx.vercel.app/` |

---

## âš™ï¸ æ¨èé…ç½®ç­–ç•¥

### ç­–ç•¥ 1: ä¸åŒå¹³å°ä¸åŒ baseï¼ˆå½“å‰æ–¹æ¡ˆï¼‰

**astro.config.ts**:
```typescript
const isLocalDev = process.env.LOCAL_DEV === 'true' || process.env.NODE_ENV === 'development';

export default defineConfig({
  site: isLocalDev 
    ? 'http://localhost:4321' 
    : (process.env.SPACESHIP_SITE || 'https://your-username.github.io'),
  base: isLocalDev 
    ? '/astro-theme-spaceship/' 
    : (process.env.SPACESHIP_BASE || '/openeducation/')
});
```

**ä¼˜ç‚¹**:
- âœ… æœ¬åœ°ã€GitHubã€Vercel å¯ä»¥ä½¿ç”¨ä¸åŒè·¯å¾„
- âœ… çµæ´»é…ç½®

**ç¼ºç‚¹**:
- âš ï¸ éœ€è¦åœ¨æ¯ä¸ªå¹³å°è®¾ç½®ç¯å¢ƒå˜é‡

---

### ç­–ç•¥ 2: ç»Ÿä¸€ä½¿ç”¨æ ¹è·¯å¾„ï¼ˆæ¨èæ–°é¡¹ç›®ï¼‰

**ä¿®æ”¹ astro.config.ts**:
```typescript
const isLocalDev = process.env.LOCAL_DEV === 'true' || process.env.NODE_ENV === 'development';

export default defineConfig({
  site: isLocalDev 
    ? 'http://localhost:4321' 
    : process.env.SPACESHIP_SITE,
  base: '/'  // æ‰€æœ‰ç¯å¢ƒéƒ½ç”¨æ ¹è·¯å¾„
});
```

**ä¼˜ç‚¹**:
- âœ… é…ç½®ç®€å•
- âœ… URL ç®€æ´
- âœ… é€‚åˆ Vercel å’Œè‡ªå®šä¹‰åŸŸå

**ç¼ºç‚¹**:
- âš ï¸ GitHub Pages éœ€è¦ä½¿ç”¨è‡ªå®šä¹‰åŸŸå
- âš ï¸ æˆ–è€…æ”¹å˜ä»“åº“è®¾ç½®ä¸º `username.github.io` ä»“åº“

---

## âš ï¸ å¸¸è§é—®é¢˜

### 1. GitHub Pages 404 é”™è¯¯

**ç°è±¡**: è®¿é—® `https://username.github.io/openeducation/` æ˜¾ç¤º 404

**åŸå› **: base è·¯å¾„é…ç½®é”™è¯¯

**è§£å†³**:
```bash
# æ£€æŸ¥ç¯å¢ƒå˜é‡
echo $SPACESHIP_BASE  # åº”è¯¥æ˜¯ /openeducation/

# æ£€æŸ¥ dist/ ç›®å½•ä¸­çš„æ–‡ä»¶è·¯å¾„
# æ‰€æœ‰é“¾æ¥åº”è¯¥åŒ…å« /openeducation/ å‰ç¼€
```

---

### 2. Vercel æ„å»ºå¤±è´¥

**ç°è±¡**: `npm run build` å¤±è´¥

**åŸå› **: ä½¿ç”¨äº†é”™è¯¯çš„æ„å»ºå‘½ä»¤

**è§£å†³**:
```json
{
  "buildCommand": "npm run build:github"  // âœ… æ­£ç¡®
  // ä¸è¦ç”¨ "npm run build" ï¼ˆä¼šåˆ é™¤ node_modulesï¼‰
}
```

---

### 3. CSS/JS æ–‡ä»¶ 404

**ç°è±¡**: é¡µé¢åŠ è½½ä½†æ ·å¼ä¸¢å¤±

**åŸå› **: base è·¯å¾„ä¸åŒ¹é…

**è§£å†³**:
1. æ£€æŸ¥ HTML ä¸­çš„èµ„æºè·¯å¾„
2. ç¡®ä¿ `base` é…ç½®æ­£ç¡®
3. æ¸…ç†ç¼“å­˜é‡æ–°æ„å»º

---

### 4. ç¯å¢ƒå˜é‡ä¸ç”Ÿæ•ˆ

**ç°è±¡**: æ„å»ºä½¿ç”¨äº†é”™è¯¯çš„é…ç½®

**GitHub Actions**:
```yaml
- name: Build
  run: npm run build:github
  env:  # âš ï¸ ç¡®ä¿åœ¨è¿™é‡Œè®¾ç½®
    SPACESHIP_BASE: /openeducation/
```

**Vercel**:
- æ£€æŸ¥ Dashboard â†’ Settings â†’ Environment Variables
- ç¡®ä¿é€‰æ‹©äº† "Production" ç¯å¢ƒ

---

### 5. Windows è·¯å¾„é—®é¢˜ï¼ˆæœ¬åœ°æ„å»ºï¼‰

**ç°è±¡**: æœ¬åœ°æ„å»ºå¤±è´¥ï¼Œè·¯å¾„åŒ…å«åæ–œæ 

**è§£å†³**: å·²é€šè¿‡ä¿®æ”¹ `get-static-paths.ts` è§£å†³
```typescript
import { join } from "node:path/posix";  // âœ… å¼ºåˆ¶ POSIX è·¯å¾„
```

---

## ğŸ” å®‰å…¨æœ€ä½³å®è·µ

### ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯

âŒ **ä¸å¥½**:
```typescript
site: 'https://mysite.com',
base: '/my-secret-project/'
```

âœ… **æ¨è**:
```typescript
site: process.env.SPACESHIP_SITE,
base: process.env.SPACESHIP_BASE || '/'
```

### ä½¿ç”¨å¹³å°çš„ Secrets åŠŸèƒ½

- **GitHub**: Settings â†’ Secrets and variables
- **Vercel**: Settings â†’ Environment Variablesï¼ˆå¯è®¾ç½®ä¸º sensitiveï¼‰

---

## ğŸ“‹ éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•

### æœ¬åœ°æ„å»ºæµ‹è¯•
- [ ] è¿è¡Œ `npm run build:github` æˆåŠŸ
- [ ] `dist/` ç›®å½•ç”Ÿæˆæ­£ç¡®
- [ ] æœ¬åœ°é¢„è§ˆ `npm run preview` æ­£å¸¸

### GitHub Pages
- [ ] `.github/workflows/deploy.yml` é…ç½®æ­£ç¡®
- [ ] ç¯å¢ƒå˜é‡è®¾ç½®å®Œæˆ
- [ ] Pages è®¾ç½®ä¸º "GitHub Actions"
- [ ] base è·¯å¾„ä¸ä»“åº“åä¸€è‡´

### Vercel
- [ ] Framework é€‰æ‹© "Astro"
- [ ] Build Command è®¾ç½®æ­£ç¡®
- [ ] ç¯å¢ƒå˜é‡é…ç½®å®Œæˆ
- [ ] åŸŸåé…ç½®ï¼ˆå¦‚éœ€è¦ï¼‰

---

## ğŸ¯ å¿«é€Ÿéƒ¨ç½²å‘½ä»¤

### GitHub Pages
```bash
# æ¨é€ä»£ç è‡ªåŠ¨è§¦å‘éƒ¨ç½²
git add .
git commit -m "Update content"
git push origin main
```

### Vercel CLI
```bash
# éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
vercel --prod

# éƒ¨ç½²åˆ°é¢„è§ˆç¯å¢ƒ
vercel
```

---

## ğŸ“š ç›¸å…³èµ„æº

- [Astro éƒ¨ç½²æ–‡æ¡£](https://docs.astro.build/en/guides/deploy/)
- [GitHub Pages æ–‡æ¡£](https://docs.github.com/en/pages)
- [Vercel æ–‡æ¡£](https://vercel.com/docs)
- [Vercel ç¯å¢ƒå˜é‡](https://vercel.com/docs/environment-variables)

---

**æœ€åæ›´æ–°**: 2025-10-21  
**ç»´æŠ¤è€…**: AI Assistant

