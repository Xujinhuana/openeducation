# ğŸ”§ æ„å»ºé…ç½®è¯´æ˜

## ğŸ“Š é…ç½®æ–‡ä»¶å¯¹ç…§è¡¨

| æ–‡ä»¶ | ç”¨é€” | æ¨¡å¼ | Adapter | éƒ¨ç½²ç›®æ ‡ |
|------|------|------|---------|----------|
| `astro.config.ts` | é»˜è®¤/Vercel | `server` | `@astrojs/vercel` | Vercel |
| `astro.config.static.ts` | GitHub Pages | `static` | æ—  | GitHub Pages |

---

## ğŸ¯ æ„å»ºå‘½ä»¤

### æœ¬åœ°å¼€å‘
```bash
npm run dev
```
- ä½¿ç”¨ï¼š`astro.config.ts`
- æ¨¡å¼ï¼š`server`
- åŠŸèƒ½ï¼šå®Œæ•´çš„ Supabase åŠŸèƒ½

### Vercel æ„å»º
```bash
npm run build:vercel
```
- ä½¿ç”¨ï¼š`astro.config.ts`
- æ¨¡å¼ï¼š`server`
- è¾“å‡ºï¼š`.vercel/output/`
- åŠŸèƒ½ï¼šå®Œæ•´çš„ Supabase åŠŸèƒ½

### GitHub Pages æ„å»º
```bash
npm run build:github
```
- ä½¿ç”¨ï¼š`astro.config.static.ts`
- æ¨¡å¼ï¼š`static`
- è¾“å‡ºï¼š`dist/`
- åŠŸèƒ½ï¼šä»…é™æ€å†…å®¹ï¼ˆæ—  Supabase åŠ¨æ€åŠŸèƒ½ï¼‰

---

## ğŸš€ éƒ¨ç½²é…ç½®

### Vercel éƒ¨ç½²

**1. `vercel.json` é…ç½®**
```json
{
  "buildCommand": "npm run build:vercel",  // â† å…³é”®
  "outputDirectory": ".vercel/output",
  "framework": "astro"
}
```

**2. ç¯å¢ƒå˜é‡**

åœ¨ Vercel Dashboard â†’ Settings â†’ Environment Variables æ·»åŠ ï¼š
```
PUBLIC_SUPABASE_URL=https://your-project-id.supabase.co
PUBLIC_SUPABASE_ANON_KEY=your-anon-key
```

**3. æ¨é€éƒ¨ç½²**
```bash
git push origin main
```

Vercel ä¼šè‡ªåŠ¨ä½¿ç”¨ `build:vercel` å‘½ä»¤æ„å»ºã€‚

---

### GitHub Pages éƒ¨ç½²

**1. GitHub Actions é…ç½®**

`.github/workflows/deploy.yml`:
```yaml
- name: Install, build, and upload your site
  uses: withastro/action@v2
  with:
    node-version: 22
    build: npm run build:github  # â† å…³é”®ï¼šä½¿ç”¨é™æ€æ„å»º
```

**2. æ¨é€éƒ¨ç½²**
```bash
git push origin main
```

GitHub Actions ä¼šè‡ªåŠ¨ä½¿ç”¨ `build:github` å‘½ä»¤æ„å»ºé™æ€ç½‘ç«™ã€‚

---

## âš ï¸ å¸¸è§é”™è¯¯

### é”™è¯¯ 1ï¼šVercel "No adapter installed"

**é”™è¯¯ä¿¡æ¯**ï¼š
```
[NoAdapterInstalled] Cannot use server-rendered pages without an adapter.
```

**åŸå› **ï¼š
- `vercel.json` ä½¿ç”¨äº† `build:github`ï¼ˆé™æ€é…ç½®ï¼‰
- æˆ– `@astrojs/vercel` æœªå®‰è£…

**è§£å†³**ï¼š
```json
// vercel.json - ä¿®æ”¹ä¸º
{
  "buildCommand": "npm run build:vercel"
}
```

---

### é”™è¯¯ 2ï¼šGitHub Actions "EEXIST: file already exists"

**é”™è¯¯ä¿¡æ¯**ï¼š
```
EEXIST: file already exists, mkdir '.vercel/output/server/'
```

**åŸå› **ï¼š
- GitHub Actions ä½¿ç”¨äº†é»˜è®¤çš„ `astro.config.ts`
- è¯¥é…ç½®åŒ…å« Vercel adapterï¼Œå°è¯•åˆ›å»º `.vercel/output` ç›®å½•

**è§£å†³**ï¼š
åœ¨ `.github/workflows/deploy.yml` ä¸­æŒ‡å®šé™æ€æ„å»ºï¼š
```yaml
with:
  build: npm run build:github  # â† æ·»åŠ è¿™è¡Œ
```

---

### é”™è¯¯ 3ï¼šæ„å»ºå‘½ä»¤ä¸ç¡®å®š

**é”™è¯¯è¡¨ç°**ï¼š
- ä¸çŸ¥é“è¯¥ç”¨å“ªä¸ªæ„å»ºå‘½ä»¤
- æ„å»ºè¾“å‡ºç›®å½•é”™è¯¯

**è§£å†³**ï¼š

| éƒ¨ç½²ç›®æ ‡ | æ„å»ºå‘½ä»¤ | é…ç½®æ–‡ä»¶ | è¾“å‡ºç›®å½• |
|---------|---------|---------|----------|
| **æœ¬åœ°å¼€å‘** | `npm run dev` | `astro.config.ts` | - |
| **Vercel** | `npm run build:vercel` | `astro.config.ts` | `.vercel/output/` |
| **GitHub Pages** | `npm run build:github` | `astro.config.static.ts` | `dist/` |

---

## ğŸ” éªŒè¯é…ç½®

### éªŒè¯ Vercel é…ç½®

**æ£€æŸ¥ `vercel.json`**ï¼š
```json
{
  "buildCommand": "npm run build:vercel",  // âœ… æ­£ç¡®
  "outputDirectory": ".vercel/output"      // âœ… æ­£ç¡®
}
```

**æœ¬åœ°æµ‹è¯•**ï¼š
```bash
npm run build:vercel
# åº”è¯¥ç”Ÿæˆ .vercel/output/ ç›®å½•
ls .vercel/output/
```

---

### éªŒè¯ GitHub Pages é…ç½®

**æ£€æŸ¥ `.github/workflows/deploy.yml`**ï¼š
```yaml
with:
  build: npm run build:github  # âœ… å¿…é¡»æŒ‡å®š
```

**æœ¬åœ°æµ‹è¯•**ï¼š
```bash
npm run build:github
# åº”è¯¥ç”Ÿæˆ dist/ ç›®å½•
ls dist/
```

---

## ğŸ“‹ å®Œæ•´æ£€æŸ¥æ¸…å•

### Vercel éƒ¨ç½²å‰

- [ ] `@astrojs/vercel` å·²å®‰è£…
- [ ] `astro.config.ts` åŒ…å« `adapter: vercel()`
- [ ] `vercel.json` çš„ `buildCommand` æ˜¯ `build:vercel`
- [ ] `vercel.json` çš„ `outputDirectory` æ˜¯ `.vercel/output`
- [ ] Vercel Dashboard å·²é…ç½®ç¯å¢ƒå˜é‡
- [ ] æœ¬åœ°æµ‹è¯• `npm run build:vercel` æˆåŠŸ

### GitHub Pages éƒ¨ç½²å‰

- [ ] `astro.config.static.ts` å­˜åœ¨
- [ ] `astro.config.static.ts` çš„ `output` æ˜¯ `static`
- [ ] `.github/workflows/deploy.yml` æŒ‡å®šäº† `build: npm run build:github`
- [ ] æœ¬åœ°æµ‹è¯• `npm run build:github` æˆåŠŸ
- [ ] ç†è§£åŠŸèƒ½é™åˆ¶ï¼ˆæ— åŠ¨æ€åŠŸèƒ½ï¼‰

---

## ğŸ¯ æ¨èå·¥ä½œæµ

```
å¼€å‘é˜¶æ®µ
â”œâ”€ npm run devï¼ˆæœ¬åœ°å¼€å‘ï¼‰
â”œâ”€ ä½¿ç”¨ astro.config.ts
â””â”€ å®Œæ•´åŠŸèƒ½æµ‹è¯•

å‡†å¤‡éƒ¨ç½²
â”œâ”€ æœ¬åœ°æµ‹è¯•æ„å»º
â”‚   â”œâ”€ npm run build:vercelï¼ˆæµ‹è¯• Vercel æ„å»ºï¼‰
â”‚   â””â”€ npm run build:githubï¼ˆæµ‹è¯• GitHub æ„å»ºï¼‰
â””â”€ æ£€æŸ¥æ„å»ºè¾“å‡º

æ¨é€ä»£ç 
â”œâ”€ git add .
â”œâ”€ git commit -m "..."
â””â”€ git push origin main

è‡ªåŠ¨éƒ¨ç½²
â”œâ”€ Vercelï¼šè‡ªåŠ¨æ£€æµ‹å¹¶éƒ¨ç½²ï¼ˆä½¿ç”¨ build:vercelï¼‰
â””â”€ GitHub Pagesï¼šGitHub Actions è‡ªåŠ¨éƒ¨ç½²ï¼ˆä½¿ç”¨ build:githubï¼‰
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

1. **ä¸è¦æ··ç”¨é…ç½®**
   - Vercel ç”¨ `astro.config.ts`
   - GitHub Pages ç”¨ `astro.config.static.ts`

2. **æ˜ç¡®æŒ‡å®šæ„å»ºå‘½ä»¤**
   - Vercelï¼šåœ¨ `vercel.json` ä¸­æŒ‡å®š
   - GitHub Pagesï¼šåœ¨ workflow ä¸­æŒ‡å®š

3. **æœ¬åœ°æµ‹è¯•**
   - éƒ¨ç½²å‰å…ˆæœ¬åœ°æµ‹è¯•æ„å»º
   - ç¡®ä¿ç”Ÿæˆæ­£ç¡®çš„è¾“å‡ºç›®å½•

4. **ç¯å¢ƒéš”ç¦»**
   - å¼€å‘ç¯å¢ƒç”¨ server æ¨¡å¼ï¼ˆå®Œæ•´åŠŸèƒ½ï¼‰
   - ç”Ÿäº§ç¯å¢ƒæ ¹æ®éƒ¨ç½²ç›®æ ‡é€‰æ‹©é…ç½®

---

## ğŸ“š ç›¸å…³æ–‡ä»¶

- `astro.config.ts` - Vercel é…ç½®ï¼ˆserver æ¨¡å¼ï¼‰
- `astro.config.static.ts` - GitHub Pages é…ç½®ï¼ˆstatic æ¨¡å¼ï¼‰
- `vercel.json` - Vercel æ„å»ºé…ç½®
- `.github/workflows/deploy.yml` - GitHub Actions é…ç½®
- `package.json` - æ„å»ºå‘½ä»¤å®šä¹‰

---

**è®°ä½**ï¼š
- ğŸ¯ Vercel = `build:vercel` = server æ¨¡å¼ = å®Œæ•´åŠŸèƒ½
- ğŸ“„ GitHub Pages = `build:github` = static æ¨¡å¼ = ä»…é™æ€

**æ¨è**ï¼šä¼˜å…ˆä½¿ç”¨ Vercel éƒ¨ç½²ï¼Œäº«å—å®Œæ•´çš„ Supabase åŠŸèƒ½ï¼ğŸš€

