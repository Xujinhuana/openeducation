# ğŸ‰ åŒç¯å¢ƒéƒ¨ç½²é…ç½®å®Œæˆ

## âœ… å·²å®Œæˆçš„é…ç½®

### 1. ç¯å¢ƒå˜é‡ç³»ç»Ÿ âœ…

**æ ¸å¿ƒå˜é‡**ï¼š`PUBLIC_ENABLE_SUPABASE`
- `'true'` â†’ å¯ç”¨ Supabase åŠŸèƒ½ï¼ˆVercelï¼‰
- `'false'` â†’ ç¦ç”¨ Supabase åŠŸèƒ½ï¼ˆGitHub Pagesï¼‰

**é…ç½®æ–‡ä»¶**ï¼š
- âœ… `.env.example` - ç¯å¢ƒå˜é‡ç¤ºä¾‹å’Œè¯´æ˜

---

### 2. ç»„ä»¶ä¿®æ”¹ âœ…

#### `src/components/ArticleStats.astro`
```astro
const enableSupabase = import.meta.env.PUBLIC_ENABLE_SUPABASE === 'true';

{enableSupabase ? (
  <!-- æ˜¾ç¤ºç»Ÿè®¡ -->
) : (
  <!-- ä¸æ˜¾ç¤º -->
)}
```

#### `src/scripts/inject-article-stats.ts`
```typescript
if (!enableSupabase) {
  console.log('Supabase åŠŸèƒ½æœªå¯ç”¨');
  // ä¸æ‰§è¡Œ
} else {
  // æ³¨å…¥ç»Ÿè®¡ç»„ä»¶
}
```

#### `src/pages/[...slug].astro`
```astro
{import.meta.env.PUBLIC_ENABLE_SUPABASE === 'true' && (
  <script>
    import '@/scripts/inject-article-stats.ts';
  </script>
)}
```

---

### 3. éƒ¨ç½²é…ç½® âœ…

#### GitHub Actions (`.github/workflows/deploy.yml`)
```yaml
env:
  PUBLIC_ENABLE_SUPABASE: 'false'  # ç¦ç”¨ Supabase
```

#### Vercel ç¯å¢ƒå˜é‡ï¼ˆéœ€åœ¨ Dashboard é…ç½®ï¼‰
```
PUBLIC_ENABLE_SUPABASE=true
PUBLIC_SUPABASE_URL=https://your-project-id.supabase.co
PUBLIC_SUPABASE_ANON_KEY=your-anon-key
```

---

## ğŸ“Š éƒ¨ç½²ç»“æœé¢„æœŸ

### GitHub Pages
```
è®¿é—®ï¼šhttps://xujinhuana.github.io/openeducation/

é¢„æœŸæ•ˆæœï¼š
  âœ… æ–‡ç« å†…å®¹æ­£å¸¸æ˜¾ç¤º
  âœ… å¯¼èˆªã€æœç´¢æ­£å¸¸
  âœ… ä¸»é¢˜åˆ‡æ¢æ­£å¸¸
  âŒ ä¸æ˜¾ç¤º "X æ¬¡æµè§ˆ"
  âŒ ä¸æ˜¾ç¤ºç‚¹èµæŒ‰é’®
  âŒ æµè§ˆå™¨æ§åˆ¶å°æ—  API é”™è¯¯
  
ç”¨æˆ·ä½“éªŒï¼š
  - çº¯é™æ€åšå®¢
  - å¿«é€ŸåŠ è½½
  - ä»…é˜…è¯»å†…å®¹
```

### Vercel
```
è®¿é—®ï¼šhttps://your-project.vercel.app/openeducation/

é¢„æœŸæ•ˆæœï¼š
  âœ… æ–‡ç« å†…å®¹æ­£å¸¸æ˜¾ç¤º
  âœ… å¯¼èˆªã€æœç´¢æ­£å¸¸
  âœ… ä¸»é¢˜åˆ‡æ¢æ­£å¸¸
  âœ… æ˜¾ç¤º "X æ¬¡æµè§ˆ"
  âœ… æ˜¾ç¤ºç‚¹èµæŒ‰é’®
  âœ… API æ­£å¸¸å·¥ä½œ
  
ç”¨æˆ·ä½“éªŒï¼š
  - å®Œæ•´åŠŸèƒ½åšå®¢
  - ç”¨æˆ·äº¤äº’
  - æ•°æ®ç»Ÿè®¡
```

---

## ğŸš€ ä¸‹ä¸€æ­¥æ“ä½œ

### âš ï¸ é‡è¦ï¼šé…ç½® Vercel ç¯å¢ƒå˜é‡

ç°åœ¨ä»£ç å·²æ¨é€ï¼Œ**å¿…é¡»**åœ¨ Vercel é…ç½®ç¯å¢ƒå˜é‡ï¼š

#### æ­¥éª¤ 1ï¼šç™»å½• Vercel
è®¿é—® https://vercel.com/dashboard

#### æ­¥éª¤ 2ï¼šé€‰æ‹©é¡¹ç›®
æ‰¾åˆ°ä½ çš„ `openeducation` é¡¹ç›®

#### æ­¥éª¤ 3ï¼šè¿›å…¥è®¾ç½®
ç‚¹å‡» **Settings** â†’ **Environment Variables**

#### æ­¥éª¤ 4ï¼šæ·»åŠ å˜é‡

ç‚¹å‡» **Add New** æŒ‰é’®ï¼Œé€ä¸ªæ·»åŠ ä»¥ä¸‹å˜é‡ï¼š

**å˜é‡ 1**ï¼š
```
Name: PUBLIC_ENABLE_SUPABASE
Value: true
Environment: Production, Preview, Development (å…¨é€‰)
```

**å˜é‡ 2**ï¼š
```
Name: PUBLIC_SUPABASE_URL
Value: https://your-project-id.supabase.co
Environment: Production, Preview, Development (å…¨é€‰)
```

**å˜é‡ 3**ï¼š
```
Name: PUBLIC_SUPABASE_ANON_KEY
Value: eyJhbGci... (ä½ çš„å®Œæ•´ anon key)
Environment: Production, Preview, Development (å…¨é€‰)
```

#### æ­¥éª¤ 5ï¼šé‡æ–°éƒ¨ç½²

æ·»åŠ ç¯å¢ƒå˜é‡åï¼ŒVercel ä¼šè‡ªåŠ¨é‡æ–°éƒ¨ç½²ã€‚æˆ–æ‰‹åŠ¨è§¦å‘ï¼š
- Deployments â†’ æœ€æ–°éƒ¨ç½² â†’ ... â†’ Redeploy

---

## ğŸ” éªŒè¯éƒ¨ç½²

### 1. æŸ¥çœ‹ GitHub Actions

è®¿é—®ï¼š`https://github.com/Xujinhuana/openeducation/actions`

**åº”è¯¥çœ‹åˆ°**ï¼š
- âœ… æœ€æ–°çš„ workflow æ­£åœ¨è¿è¡Œ
- âœ… "Build with Astro (Static for GitHub Pages)" æ­¥éª¤
- âœ… æ„å»ºæˆåŠŸï¼ˆç»¿è‰² âœ“ï¼‰
- âœ… éƒ¨ç½²æˆåŠŸ

---

### 2. æŸ¥çœ‹ Vercel

è®¿é—®ï¼š`https://vercel.com/dashboard`

**åº”è¯¥çœ‹åˆ°**ï¼š
- âœ… æœ€æ–°çš„éƒ¨ç½²æ­£åœ¨æ„å»º
- âœ… æ„å»ºæˆåŠŸ
- âœ… æ—  "EEXIST" é”™è¯¯

---

### 3. æµ‹è¯• GitHub Pages ç«™ç‚¹

è®¿é—®ï¼š`https://xujinhuana.github.io/openeducation/`

**æ£€æŸ¥æ¸…å•**ï¼š
- [ ] æ‰“å¼€ä»»æ„æ–‡ç« é¡µé¢
- [ ] æ–‡ç« å†…å®¹æ­£å¸¸æ˜¾ç¤º
- [ ] **ä¸æ˜¾ç¤º**æµè§ˆé‡æ•°å­—
- [ ] æŒ‰ F12 æ‰“å¼€æ§åˆ¶å°
- [ ] Console ä¸­çœ‹åˆ°ï¼š`[ArticleStats] Supabase åŠŸèƒ½æœªå¯ç”¨ï¼Œè·³è¿‡ç»Ÿè®¡ç»„ä»¶æ³¨å…¥`
- [ ] Network æ ‡ç­¾ä¸­**æ²¡æœ‰** `/api/stats` è¯·æ±‚

---

### 4. æµ‹è¯• Vercel ç«™ç‚¹

è®¿é—®ï¼š`https://your-project.vercel.app/openeducation/`

**æ£€æŸ¥æ¸…å•**ï¼š
- [ ] æ‰“å¼€ä»»æ„æ–‡ç« é¡µé¢
- [ ] æ–‡ç« å†…å®¹æ­£å¸¸æ˜¾ç¤º
- [ ] **æ˜¾ç¤º**æµè§ˆé‡æ•°å­—ï¼ˆä¾‹å¦‚ï¼š"5 æ¬¡æµè§ˆ"ï¼‰
- [ ] æŒ‰ F12 æ‰“å¼€æ§åˆ¶å°
- [ ] Console ä¸­çœ‹åˆ°ï¼š`[ArticleStats] Supabase åŠŸèƒ½å·²å¯ç”¨ï¼Œæ³¨å…¥ç»Ÿè®¡ç»„ä»¶`
- [ ] Network æ ‡ç­¾ä¸­æœ‰ `/api/stats` è¯·æ±‚ä¸”è¿”å› 200

---

## ğŸ“ ä»£ç å·²æ¨é€

```bash
âœ… git add .
âœ… git commit -m "feat: å®ç°åŒç¯å¢ƒéƒ¨ç½² - GitHub Pagesé™æ€ç‰ˆ + Vercelå®Œæ•´ç‰ˆ"
âœ… git push origin main
```

### ä¿®æ”¹çš„æ–‡ä»¶

1. âœ… `.env.example` - ç¯å¢ƒå˜é‡ç¤ºä¾‹ï¼ˆæ–°å»ºï¼‰
2. âœ… `src/components/ArticleStats.astro` - æ·»åŠ ç¯å¢ƒåˆ¤æ–­
3. âœ… `src/scripts/inject-article-stats.ts` - æ·»åŠ ç¯å¢ƒæ£€æŸ¥
4. âœ… `src/pages/[...slug].astro` - æ¡ä»¶æ³¨å…¥è„šæœ¬
5. âœ… `.github/workflows/deploy.yml` - è®¾ç½® `PUBLIC_ENABLE_SUPABASE: 'false'`
6. âœ… `vercel.json` - æ„å»ºå‘½ä»¤ä¼˜åŒ–
7. âœ… `åŒç¯å¢ƒéƒ¨ç½²æŒ‡å—.md` - å®Œæ•´æ–‡æ¡£ï¼ˆæ–°å»ºï¼‰
8. âœ… `SSRè¯¦è§£.md` - SSR æ¦‚å¿µè¯´æ˜ï¼ˆæ–°å»ºï¼‰
9. âœ… `éƒ¨ç½²ç»ˆææ–¹æ¡ˆ.md` - éƒ¨ç½²æ–¹æ¡ˆå¯¹æ¯”ï¼ˆæ–°å»ºï¼‰

---

## ğŸ¯ æ ¸å¿ƒå®ç°æœºåˆ¶

### ç¯å¢ƒæ£€æµ‹
```typescript
const enableSupabase = import.meta.env.PUBLIC_ENABLE_SUPABASE === 'true';
```

### æ¡ä»¶æ¸²æŸ“
```astro
{enableSupabase ? (
  <!-- Vercel: æ˜¾ç¤ºåŠŸèƒ½ -->
) : (
  <!-- GitHub Pages: éšè—åŠŸèƒ½ -->
)}
```

### æ¡ä»¶æ‰§è¡Œ
```typescript
if (!enableSupabase) {
  // è·³è¿‡
} else {
  // æ‰§è¡Œ Supabase ç›¸å…³ä»£ç 
}
```

---

## ğŸ“š åˆ›å»ºçš„æ–‡æ¡£

| æ–‡æ¡£ | ç”¨é€” |
|------|------|
| `åŒç¯å¢ƒéƒ¨ç½²æŒ‡å—.md` | å®Œæ•´çš„éƒ¨ç½²é…ç½®è¯´æ˜ |
| `SSRè¯¦è§£.md` | SSR æ¦‚å¿µå’Œå¿…è¦æ€§è¯´æ˜ |
| `éƒ¨ç½²ç»ˆææ–¹æ¡ˆ.md` | éƒ¨ç½²æ–¹æ¡ˆå¯¹æ¯”å’Œå»ºè®® |
| `éƒ¨ç½²é…ç½®æ€»ç»“.md` | æœ¬æ¬¡é…ç½®çš„æ€»ç»“ |
| `.env.example` | ç¯å¢ƒå˜é‡ç¤ºä¾‹ |

---

## âš ï¸ é‡è¦ï¼šVercel ç¯å¢ƒå˜é‡

**ç°åœ¨å¿…é¡»åšçš„**ï¼š

åœ¨ Vercel Dashboard é…ç½®ç¯å¢ƒå˜é‡ï¼Œå¦åˆ™ Vercel éƒ¨ç½²åä¹Ÿä¸ä¼šæ˜¾ç¤ºç»Ÿè®¡åŠŸèƒ½ï¼

```
PUBLIC_ENABLE_SUPABASE=true
PUBLIC_SUPABASE_URL=https://your-project-id.supabase.co
PUBLIC_SUPABASE_ANON_KEY=your-anon-key
```

---

## ğŸ‰ å®Œæˆï¼

ä»£ç å·²æ¨é€åˆ° GitHubï¼Œç°åœ¨ï¼š

1. **GitHub Actions** æ­£åœ¨è‡ªåŠ¨æ„å»ºéƒ¨ç½²åˆ° GitHub Pagesï¼ˆç¦ç”¨ Supabaseï¼‰
2. **Vercel** æ­£åœ¨è‡ªåŠ¨æ„å»ºéƒ¨ç½²ï¼ˆéœ€è¦ä½ é…ç½®ç¯å¢ƒå˜é‡åæ‰ä¼šå¯ç”¨ Supabaseï¼‰

---

## ğŸ“‹ éªŒè¯æ­¥éª¤

### 10 åˆ†é’Ÿåæ£€æŸ¥

1. **GitHub Actions** 
   - è®¿é—® https://github.com/Xujinhuana/openeducation/actions
   - æŸ¥çœ‹æœ€æ–°çš„ workflow
   - åº”è¯¥æ˜¾ç¤º âœ… æˆåŠŸ

2. **Vercel**
   - è®¿é—® https://vercel.com/dashboard
   - æŸ¥çœ‹æœ€æ–°çš„éƒ¨ç½²
   - **é…ç½®ç¯å¢ƒå˜é‡åé‡æ–°éƒ¨ç½²**

3. **æµ‹è¯•ç½‘ç«™**
   - GitHub Pagesï¼šä¸æ˜¾ç¤ºæµè§ˆé‡ï¼ˆç¬¦åˆé¢„æœŸï¼‰
   - Vercelï¼šæ˜¾ç¤ºæµè§ˆé‡ï¼ˆé…ç½®ç¯å¢ƒå˜é‡åï¼‰

---

**éœ€è¦æˆ‘å¸®ä½ é…ç½® Vercel ç¯å¢ƒå˜é‡å—ï¼Ÿæˆ–è€…ä½ æœ‰å…¶ä»–é—®é¢˜ï¼Ÿ** ğŸš€

