# 📸 图床配置指南 - PicGo + 七牛云

> 国内最快的图床方案，免费 10GB 存储 + 10GB CDN 流量

---

## 🎯 方案优势

### 为什么选择七牛云？

- ✅ **国内访问速度最快**（50-150ms，比其他方案快 3-5 倍）
- ✅ **免费额度高**（10GB 存储 + 10GB CDN 流量/月）
- ✅ **强大的图片处理**（缩略图、压缩、水印、格式转换）
- ✅ **稳定可靠**（大厂服务，99.9% 可用性）
- ✅ **无需信用卡**（只需实名认证）
- ✅ **PicGo 原生支持**（配置简单）

### 免费额度详情

```yaml
每月免费额度：
  存储空间: 10 GB
  HTTP 下载流量: 10 GB
  HTTPS 下载流量: 10 GB
  PUT/DELETE 请求: 10 万次
  GET 请求: 100 万次

实际使用估算：
  可存储图片: 约 5,000-10,000 张
  可支持访问: 月 5-10 万次
  适合规模: 个人博客到中型网站
```

---

## 📋 完整配置流程

### 第一步：注册账号（5 分钟）

#### 1.1 注册七牛云账号

1. **访问七牛云官网**：https://portal.qiniu.com/signup

2. **填写注册信息**：
   ```
   手机号码: 输入您的手机号
   短信验证码: 点击获取并填入
   密码: 设置账号密码
   ```

3. **点击"注册"**

4. **登录账号**

#### 1.2 实名认证（必须）

1. **进入认证页面**：
   ```
   控制台 → 右上角头像 → 账号设置 → 实名认证
   ```

2. **选择认证类型**：
   ```
   个人认证（推荐）
   ```

3. **填写认证信息**：
   ```
   真实姓名: 与身份证一致
   身份证号: 18 位身份证号
   上传证件: 身份证正反面照片
   ```

4. **提交审核**：
   - 通常 1-2 小时内完成
   - 审核通过后会收到短信通知

**⚠️ 注意**：
- 实名认证是使用七牛云的必要条件
- 信息会严格保密，符合国家法规要求
- 认证后才能创建存储空间

---

### 第二步：创建存储空间（5 分钟）

#### 2.1 进入对象存储

```
控制台 → 产品与服务 → 对象存储 Kodo → 空间管理
```

#### 2.2 新建存储空间

1. **点击"新建空间"**

2. **配置存储空间**：

| 配置项 | 推荐值 | 说明 |
|--------|--------|------|
| **空间名称** | `blog-images` | 只能包含字母、数字、- 和 _ |
| **存储区域** | 华东-浙江 | 选择离你最近的区域 |
| **访问控制** | 公开空间 | 必须选择公开 |

**存储区域选择建议**：
```
华东-浙江: 适合华东地区（上海、江苏、浙江等）
华北-河北: 适合华北地区（北京、天津、河北等）
华南-广东: 适合华南地区（广东、广西、福建等）
```

3. **点击"确定创建"**

4. **记录空间名称**：`blog-images`

---

### 第三步：获取密钥（3 分钟）

#### 3.1 进入密钥管理

```
控制台 → 右上角头像 → 密钥管理
```


#### 3.2 查看或创建密钥

1. **查看现有密钥**：
   - 如果已有密钥，直接使用
   - 点击"显示"查看 SecretKey
  

2. **创建新密钥**（如果需要）：
   - 点击"创建密钥"
   - 系统自动生成

3. **复制并保存密钥**：
   ```
   AccessKey (AK): 类似 WsOzV7ahe9o_3rze5gawajH19LrQPcOmb4wnW1ws
   SecretKey (SK): 类似 xo4srgu96fmnGd8hcyV3ouB0Gzlr1YsZgkqowaZxe
   ```

**⚠️ 重要提示**：
- 密钥相当于密码，请妥善保管
- 不要分享给他人
- 不要提交到 Git 仓库
- 建议保存在密码管理器中

---

### 第四步：配置加速域名（10 分钟）

#### 4.1 使用测试域名（快速开始，推荐）

1. **进入空间管理**：
   ```
   对象存储 → 空间管理 → 选择你的空间 → 域名管理
   ```

2. **查看测试域名**：
   ```
   系统会自动分配一个测试域名：
   http://xxxxx.test.qiniucdn.com
   ```

3. **复制测试域名**（配置 PicGo 时使用）

**⚠️ 测试域名限制**：
- 有效期 30 天
- 限速（不适合高流量）
- 仅用于测试
- 建议后续绑定自己的域名

#### 4.2 绑定自定义域名（推荐，需要备案域名）

**前提条件**：
- ✅ 你有一个域名
- ✅ 域名已完成备案（必须！）

**配置步骤**：

1. **在七牛云添加域名**：
   ```
   域名管理 → 添加域名
   
   域名类型: CDN 加速域名
   自定义域名: img.yourdomain.com
   覆盖范围: 中国大陆
   通信协议: HTTP（可选 HTTPS）
   ```

2. **配置 CNAME 记录**：
   ```
   在你的域名服务商（如阿里云、腾讯云）添加 CNAME 记录：
   
   主机记录: img
   记录类型: CNAME
   记录值: 七牛云提供的 CNAME 值（如：xxx.qiniucdn.com）
   TTL: 10 分钟
   ```

3. **等待生效**：
   - 通常 5-30 分钟
   - 可以用 ping 测试是否生效

4. **配置 HTTPS**（可选）：
   ```
   域名管理 → HTTPS 配置
   上传 SSL 证书或使用免费证书
   ```

---

### 第五步：安装 PicGo（5 分钟）

#### 5.1 下载 PicGo



### 第六步：配置七牛云图床（10 分钟）

#### 6.1 打开图床设置

```
PicGo 主界面 → 图床设置 → 七牛图床
```

#### 6.2 填写配置信息

| 配置项 | 填写内容 | 示例 |
|--------|----------|------|
| **AccessKey** | 第三步获取的 AK | `abc123def456...` |
| **SecretKey** | 第三步获取的 SK | `xyz789uvw012...` |
| **存储空间名** | 第二步创建的空间名 | `blog-images` |
| **访问网址** | 第四步的域名（含 http://） | `http://xxxxx.test.qiniucdn.com` |
| **存储区域** | 根据第二步选择 | 见下表 |
| **存储路径** | 图片保存路径 | `images/` |
| **网址后缀** | 留空 | （不填） |

**存储区域代码表**：

| 区域名称 | 代码 |
|----------|------|
| 华东-浙江 | `z0` |
| 华东-浙江2 | `cn-east-2` |
| 华北-河北 | `z1` |
| 华南-广东 | `z2` |
| 北美-洛杉矶 | `na0` |
| 亚太-新加坡 | `as0` |

**完整配置示例**：

```yaml
AccessKey: abc123def456789xyz
SecretKey: uvw012345678901234
存储空间名: blog-images
访问网址: http://t4kp6l5jw.hd-bkt.clouddn.com
存储区域: z0
存储路径: images/
网址后缀: （留空）
```

#### 6.3 保存设置

1. 点击"确定"保存配置
2. 点击"设为默认图床"

---

### 第七步：测试上传（5 分钟）

#### 7.1 拖拽上传测试

1. **准备一张测试图片**

2. **打开 PicGo 上传区**：
   ```
   PicGo 主界面 → 上传区
   ```

3. **拖拽图片到上传区**

4. **等待上传完成**：
   - 进度条显示上传进度
   - 上传成功后显示"上传成功"

5. **查看结果**：
   - URL 自动复制到剪贴板
   - 格式：`http://xxxxx.test.qiniucdn.com/images/图片名.jpg`

#### 7.2 验证图片访问

1. **打开浏览器**

2. **粘贴 URL**（Ctrl+V）

3. **确认图片正常显示**

4. **检查加载速度**：
   - F12 打开开发者工具
   - Network 标签查看加载时间
   - 应该在 50-150ms 内

#### 7.3 查看上传历史

```
PicGo → 相册
```

可以看到：
- 所有上传的图片
- 缩略图预览
- 复制链接
- 删除图片

---

## 🔧 高级配置

### 配置 1：自定义快捷键

```
PicGo → 设置 → 快捷键设置

推荐配置：
- 上传剪贴板图片: Ctrl+Shift+U
- 上传选择的文件: Ctrl+Shift+O
- 打开主窗口: Ctrl+Shift+P
```

**使用方法**：
```
1. 截图（Win+Shift+S）
2. 按 Ctrl+Shift+U
3. 自动上传并复制链接
4. 粘贴到 Markdown（Ctrl+V）
```

---

### 配置 2：自动重命名

```
PicGo → 设置 → 时间戳重命名

推荐格式：
- {y}{m}{d}-{timestamp}
- 结果示例：20241023-1698052820.jpg
```

**好处**：
- 避免文件名冲突
- 便于按日期查找
- 文件名更规范

---

### 配置 3：图片压缩（可选）

#### 3.1 安装压缩插件

```
PicGo → 插件设置 → 搜索"compress"
安装：picgo-plugin-compress
```

#### 3.2 配置压缩参数

```
插件设置 → picgo-plugin-compress

推荐配置：
- 压缩质量: 80
- 最大宽度: 1920
- 最大高度: 1920
```

**效果**：
```
压缩前: 2.5 MB
压缩后: 400 KB
视觉效果: 几乎无损
流量节省: 80%+
```

---

### 配置 4：开启 PicGo 服务器（Obsidian 集成必需）

```
PicGo → 设置 → 设置 Server

配置：
- ✅ 开启 Server
- 监听端口: 36677（默认）
- 监听地址: 127.0.0.1
```

**作用**：
- 允许 Obsidian 插件调用 PicGo
- 实现粘贴自动上传
- 支持批量上传

---

## 📝 Obsidian 集成配置

### 安装 Obsidian 插件

#### 步骤 1：安装插件

```
Obsidian → 设置 → 第三方插件 → 浏览

搜索：Image auto upload Plugin
点击：安装 → 启用
```

#### 步骤 2：配置插件

```
插件设置：

Default uploader: PicGo
PicGo server: http://127.0.0.1:36677

✅ Upload on clipboard
✅ Auto upload when paste image
✅ Apply image settings
```

#### 步骤 3：设置快捷键

```
Obsidian → 设置 → 快捷键

搜索：Image auto upload
设置：
- Upload all images: Ctrl+Shift+U
- Upload single image: Ctrl+Shift+I
```

---

### 使用方法

#### 方式 1：粘贴自动上传（最常用）

```
1. 在任何地方截图（Win+Shift+S）
2. 在 Obsidian 中粘贴（Ctrl+V）
3. 插件自动调用 PicGo 上传
4. 自动替换为七牛云链接

效果：
![](http://xxxxx.test.qiniucdn.com/images/xxx.jpg)
```

#### 方式 2：批量上传本地图片

```
1. 笔记中有本地图片引用：![](local-image.png)
2. 按快捷键 Ctrl+Shift+U
3. 所有本地图片批量上传
4. 自动替换为七牛云链接
```

#### 方式 3：单张图片上传

```
1. 光标放在图片链接上
2. 按快捷键 Ctrl+Shift+I
3. 该图片上传
4. 自动替换链接
```

---

## 🎨 七牛云图片处理功能

### 图片处理语法

七牛云支持通过 URL 参数处理图片，无需额外开发！

#### 基础语法

```
原图 URL：
http://your-domain.com/images/photo.jpg

处理后 URL：
http://your-domain.com/images/photo.jpg?参数
```

---

### 常用处理示例

#### 1. 缩略图（按宽度）

```
http://your-domain.com/images/photo.jpg?imageView2/2/w/800

参数说明：
- imageView2/2：缩略模式
- w/800：宽度 800px，高度等比缩放
```

#### 2. 固定尺寸（裁剪居中）

```
http://your-domain.com/images/photo.jpg?imageView2/1/w/800/h/600

参数说明：
- imageView2/1：裁剪模式
- w/800：宽度 800px
- h/600：高度 600px
```

#### 3. 压缩质量

```
http://your-domain.com/images/photo.jpg?imageView2/2/q/80

参数说明：
- q/80：质量 80%（1-100）
```

#### 4. 格式转换

```
# 转为 WebP（更小的文件）
http://your-domain.com/images/photo.jpg?imageMogr2/format/webp

# 转为 PNG
http://your-domain.com/images/photo.jpg?imageMogr2/format/png
```

#### 5. 添加水印

```
http://your-domain.com/images/photo.jpg?watermark/2/text/QXN0ck9i

参数说明：
- watermark/2：图片水印
- text/xxx：Base64 编码的水印文字
```

#### 6. 组合使用

```
# 缩略 + 压缩 + WebP
http://your-domain.com/images/photo.jpg?imageView2/2/w/800/q/80/format/webp

效果：
- 宽度 800px
- 质量 80%
- WebP 格式
- 文件大小可能减少 70-90%
```

---

### 在 Markdown 中使用

```markdown
原图：
![](http://your-domain.com/images/photo.jpg)

缩略图（宽度 800）：
![](http://your-domain.com/images/photo.jpg?imageView2/2/w/800)

高质量缩略图（宽度 800，质量 90%）：
![](http://your-domain.com/images/photo.jpg?imageView2/2/w/800/q/90)

WebP 格式：
![](http://your-domain.com/images/photo.jpg?imageMogr2/format/webp)
```

---

## 📊 监控流量使用

### 查看统计数据

```
控制台 → 对象存储 → 统计分析

可以查看：
- 存储空间使用量
- 下载流量
- 请求次数
- 按日期统计
```

### 设置流量告警

```
控制台 → 费用中心 → 余额告警

设置：
- 余额低于 XX 元时通知
- 邮件或短信提醒
```

**建议**：
- 设置每日查看习惯
- 月初检查上月流量
- 接近限额时优化图片

---

## 💰 费用说明

### 免费额度

```yaml
每月免费：
  存储: 10 GB
  HTTP 流量: 10 GB
  HTTPS 流量: 10 GB
  GET 请求: 100 万次
  PUT 请求: 10 万次

适合场景：
  个人博客: ✅ 绰绰有余
  小型网站: ✅ 基本够用
  中型网站: ⚠️ 可能需要付费
```

### 超出后的计费

```yaml
存储费用:
  标准存储: ¥0.148/GB/月

流量费用:
  HTTP: ¥0.29/GB
  HTTPS: ¥0.36/GB

请求费用:
  GET: ¥0.01/万次
  PUT: ¥0.01/万次
```

### 节省流量技巧

1. **使用图片压缩**
   - 上传前压缩
   - 或使用七牛云 URL 参数压缩

2. **使用 WebP 格式**
   - 文件大小减少 30-80%
   - 现代浏览器都支持

3. **合理设置缓存**
   - 浏览器缓存图片
   - 减少重复请求

4. **删除不用的图片**
   - 定期清理旧图片
   - 释放存储空间

---

## ⚠️ 常见问题解决

### Q1: 上传失败，提示 401 错误

**原因**：AccessKey 或 SecretKey 错误

**解决方法**：
```
1. 重新检查 AK 和 SK 是否正确
2. 注意不要有多余的空格
3. 重新生成密钥并更新配置
```

---

### Q2: 上传成功但图片不显示

**原因 1**：存储空间不是"公开空间"

**解决方法**：
```
对象存储 → 空间管理 → 你的空间 → 空间概览
访问控制: 改为"公开空间"
```

**原因 2**：访问网址配置错误

**解决方法**：
```
检查 PicGo 中的"访问网址"：
✅ 正确: http://xxxxx.test.qiniucdn.com
❌ 错误: http://xxxxx.test.qiniucdn.com/
❌ 错误: xxxxx.test.qiniucdn.com（缺少 http://）
```

---

### Q3: 测试域名 30 天后过期

**解决方法**：

**方案 1**：绑定自己的域名（推荐）
```
需要：
- 已备案的域名
- 在七牛云绑定域名
- 配置 CNAME 记录
```

**方案 2**：更换存储空间
```
创建新的存储空间，获得新的测试域名
迁移图片到新空间
```

---

### Q4: 图片加载很慢

**可能原因和解决方法**：

1. **使用了 HTTPS 而测试域名只支持 HTTP**
   ```
   解决：访问网址使用 http:// 开头
   ```

2. **图片文件太大**
   ```
   解决：启用图片压缩插件
   或使用七牛云 URL 参数压缩
   ```

3. **网络问题**
   ```
   解决：检查本地网络
   尝试其他存储区域
   ```

---

### Q5: Obsidian 插件不工作

**检查清单**：

- [ ] PicGo 正在运行（系统托盘有图标）
- [ ] PicGo Server 已开启（设置 → 设置 Server）
- [ ] 端口是 36677
- [ ] Obsidian 插件配置正确
- [ ] 尝试重启 PicGo 和 Obsidian

---

## ✅ 配置完成检查清单

### 七牛云配置

- [ ] 账号已注册
- [ ] 实名认证已完成（1-2 小时）
- [ ] 存储空间已创建（公开空间）
- [ ] AccessKey 已获取并保存
- [ ] SecretKey 已获取并保存
- [ ] 域名已配置（测试域名或自定义域名）

### PicGo 配置

- [ ] PicGo 已安装
- [ ] 七牛云图床已配置
- [ ] 配置信息填写正确
- [ ] 已设为默认图床
- [ ] 快捷键已设置
- [ ] Server 已开启（如需 Obsidian 集成）

### 功能测试

- [ ] 拖拽上传测试成功
- [ ] 图片可以在浏览器正常访问
- [ ] 加载速度满意（< 200ms）
- [ ] 可以在相册查看历史
- [ ] Obsidian 插件工作正常（如已配置）

---

## 🎉 配置完成！

恭喜！您已经成功配置了**七牛云图床**。

### 现在您可以：

- 📸 截图后一键上传（Ctrl+Shift+U）
- 🚀 图片从 CDN 加速访问（50-150ms）
- 🎨 使用强大的图片处理功能
- 💾 Git 仓库保持轻量（不含图片）
- 📝 在 Obsidian 中愉快地编写博客

---

### 完整工作流

```
编写博客（Obsidian）
    ↓
截图/插入图片
    ↓
粘贴（Ctrl+V）
    ↓
自动上传到七牛云
    ↓
自动插入 CDN 链接
    ↓
Git 提交（不含图片）
    ↓
部署网站
    ↓
图片从七牛云 CDN 加速加载
```

---

## 📚 参考资源

### 官方文档

- [七牛云官方文档](https://developer.qiniu.com/)
- [七牛云图片处理 API](https://developer.qiniu.com/dora/manual/1279/basic-processing-images-imageview2)
- [PicGo 官方文档](https://picgo.github.io/PicGo-Doc/)

### 快速链接

- [七牛云控制台](https://portal.qiniu.com/)
- [PicGo GitHub](https://github.com/Molunerfinn/PicGo)
- [Obsidian Image Plugin](https://github.com/renmu123/obsidian-image-auto-upload-plugin)

---

**祝使用愉快！** 🎉

有任何问题欢迎查看常见问题章节或联系支持。

